{% extends '@App/layout.html.twig' %}

{% block content %}
    <div class="row">
        <div class="col-xs-12 col-sm-6 col-sm-offset-3 col-lg-4 col-lg-offset-4">

            {% if not error %}
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Définir un mot de passe</h3>
                    </div>
                    <div class="panel-body">
                        <p>
                            Quel mot de passe souhaitez-vous utiliser pour vous connecter à votre compte Evo'Portail ?
                        </p>

                        {{ form_start(form) }}
                            {{ form_errors(form) }}
                            <div class="form-group">
                                {{ form_row(form.passwordPlain.first) }}
                            </div>
                            <div class="form-group">
                                {{ form_row(form.passwordPlain.second) }}
                            </div>

                            {{ form_widget(form.username) }}
                            {{ form_widget(form.passwordToken) }}

                            <div class="text-center">
                                <input type="submit" value="Valider" class="btn btn-primary" />
                            </div>
                        {{ form_end(form) }}

                        {#<form id="change-password" action="{{ path("evo_security_password_resetted") }}" method="post">#}
                            {#<div class="form-group">#}
                                {#<input type="password" class="form-control" id="password" name="password" placeholder="Votre mot de passe (8 caractères min)" minlength="8" required/>#}
                            {#</div>#}
                            {#<div class="form-group">#}
                                {#<input type="password" class="form-control" id="password-confirm" name="password-confirm" placeholder="Confirmez votre mot de passe" minlength="8" required/>#}
                            {#</div>#}
                            {#<div class="text-center">#}
                                {#<input type="submit" value="Valider" class="btn btn-primary" />#}
                            {#</div>#}

                            {#<div class="row">#}
                                {#<div class="col-sm-4 col-sm-offset-4 text-center">#}
                                    {#<input type="hidden" id="mail" name="mail" value="{{ username }}"/>#}
                                    {#<input type="hidden" id="token" name="token" value="{{ token }}"/>#}
                                {#</div>#}
                            {#</div>#}
                        {#</form>#}
                    </div>
                </div>
            {% else %}
                Pour faire une nouvelle demande de mot de passe, <a href="{{ path("evo_security_password_retrieval") }}" class="text-red">cliquez-ici</a>.
            {% endif %}



        </div>
    </div>
{% endblock content %}


{% block javascripts %}
<script type="text/javascript">
$(function() {
    $( "#change-password" ).validate({
        rules: {
            "password-confirm": {
                equalTo: "#password"
            }
        },
        messages: {
            "password-confirm": {
                equalTo: "Vos deux mots de passe ne sont pas identiques."
            }
        }
    });
});
</script>
{% endblock javascripts %}